{
    "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
  "parameters": {
    "workflows_name": {
      "defaultValue": "LogicAppToSendMailFromADF",
      "type": "String"
    },
    "connections_office365_externalid": {
      "defaultValue": "/subscriptions/81ec4907-9db6-4d56-86d4-d997209d7be6/resourceGroups/RG-data-pipeline-framework-poc/providers/Microsoft.Web/connections/office365",
      "type": "String"
    }
  },
    "variables": {},
    "resources": [
      {
        "type": "Microsoft.Logic/workflows",
        "apiVersion": "2017-07-01",
        "name": "[parameters('workflows_name')]",
        "location": "eastus",
        "properties": {
          "state": "Enabled",
          "definition": {
            "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
            "contentVersion": "1.0.0.0",
            "parameters": {
              "$connections": {
                "defaultValue": {},
                "type": "Object"
              }
            },
            "triggers": {
              "manual": {
                "type": "Request",
                "kind": "Http",
                "inputs": {
                  "schema": {
                    "properties": {
                      "Activity": {
                        "type": "string"
                      },
                      "DataFactoryName": {
                        "type": "string"
                      },
                      "EmailTo": {
                        "type": "string"
                      },
                      "Message": {
                        "type": "string"
                      },
                      "PipelineName": {
                        "type": "string"
                      },
                      "Subject": {
                        "type": "string"
                      }
                    },
                    "type": "object"
                  }
                }
              }
            },
            "actions": {
              "Send_an_email_(V2)": {
                "runAfter": {},
                "type": "ApiConnection",
                "inputs": {
                  "body": {
                    "Body": "<p>The Message: @{triggerBody()?['Message']}<br>\nThe data factory name: @{triggerBody()?['DataFactoryName']}<br>\n</p>",
                    "Subject": "@triggerBody()?['Message']",
                    "To": "@triggerBody()?['EmailTo']"
                  },
                  "host": {
                    "connection": {
                      "name": "@parameters('$connections')['office365']['connectionId']"
                    }
                  },
                  "method": "post",
                  "path": "/v2/Mail"
                }
              }
            },
            "outputs": {}
          },
          "parameters": {
            "$connections": {
              "value": {
                "office365": {
                  "connectionId": "[parameters('connections_office365_externalid')]",
                  "connectionName": "office365",
                  "id": "/subscriptions/81ec4907-9db6-4d56-86d4-d997209d7be6/providers/Microsoft.Web/locations/eastus/managedApis/office365"
                }
              }
            }
          }
        }
      }
    ]
}